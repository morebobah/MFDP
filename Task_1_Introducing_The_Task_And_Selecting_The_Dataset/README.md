# Домашнее задание №1. Презентация задачи и выбор датасета.

## Бизнес-анализ
Экпоненциальный рост услуг по онлайн продаже товаров уложняет процесс выбора при их использовании, одновременно с этим усложняется для бизнеса и эффективное продвижение своей продукции. В таких условиях рекомендательные системы становятся ключевым инструментом, способным не только улучшить пользовательский опыт, но и значительно повысить прибыль компаний. При разработке рекомендательных систем лучшение клиентского опыта возможно проводить в нескольких направлениях, в частности, путем персонализации взаимодействия на основе предпочтений и поведения клиента, учета сезонности, праздников, истории покупок и демографии. Одной из целей проекта предполагается повышение прибыли компаний использующих разрабатывамую рекомендательную систему.

В качестве заказчика проекта может выступать компания по online продаже специализированных товаров которая расширяет бизнес путем универсализации ассортимента. На первых этапах развития может быть использовано готовое решение, например, Recombee, который позволит добиться увеличения среднего чека на покупку и увеличит конверсию в покупку. В последующем, если анализ продаж покажет, что имеющеюся решение не в полной мере отвечает потребностям бизнеса можно будет перейти на решение разрабатываемое в рамках данного проекта, в частности бизнес может не устроить следующие недостатки готовой системы:
- Отсутствует учет сезонности и предложений товаров для покупок впрок, летом купить лошадь, но можно и сани зато дешевле;
- Нет возможности учитывать регион запросов от покупателя.
- Не учитывается сезонность и тренды.
- Нет гибких правил для ручной корректировки весов для повышения релевантности сезонных товаров.
- Не учитывают контекстные факторы.
- Необходимость использовать чувствительные данные за пределами контура компании.


**Таким образом, полная бизнес цель проекта: повышение выручки компаний использующих разрабатываемую рекомендательную систему на 3%, путем увеличинения среднего чека покупки на 2% и увеличения конверсии в покупку на 1%.**

Со стороны заказчика реализация проекта потребует следующей организационной структуры и ролей:
- **Менеджер продукта** – отвечает за постановку задач и приоритезацию.
- **Аналитик данных** – предоставляют требования по данным и метрикам.
- **Маркетинг-менеджер** – определяет бизнес-потребности (сезонные акции, персонализация).
- **Техлид / CTO** – курирует интеграцию системы в текущую ИТ-инфраструктуру.

Исполнитель:
- **Разработчик/QA-инженер** – реализуют функционал.  


Основными пользователями системы определены:
- **Покупатели** – получают персонализированные рекомендации.
- **Маркетологи** – используют систему для таргетированных промо-кампаний.
- **Аналитики** – оценивают эффективность рекомендаций.

## Текущая ситуация
Система будет интегрировано в существующую систем продаж путем добавления дополнительного сервера, и размещением его в центре обработки данных компании.
Исходим из того, что в систему поступает два запроса в секунду 2RPS, что соответствует приблизительно 7000 пользователей в час.
Для отказустойчивой системы потребуются следующее аппаратное обеспечение:
**Cервер для базы данных**, конфигурация:<br />
- CPU: 8–16 ядер (лучше с высоким IPC, например AMD EPYC / Intel Xeon).
- RAM: 32–64 ГБ (PostgreSQL предпочитает размещать кэш в RAM).
- SSD: 500 ГБ – 1 ТБ NVMe (для быстрых запросов).

**Сервер для бэкэнда**, конфигурация:<br />
- CPU: 4–8 ядер (например, Intel Xeon E-2300 / AMD Ryzen 9).
- RAM: 16–32 ГБ (хватит с запасом для 2 RPS).
- SSD: 256–512 ГБ (для ОС и кэша).

**Сервер для работы ML модели**, конфигурация:<br />
- CPU: Многоядерные процессоры (Intel Xeon, AMD EPYC)
- RAM: 64 ГБ.
- SSD: 2x512 ГБ.
- HDD: 2x1 ТБ.
- GPU: NVIDIA RTX 4090

Предполагается, что заказчик уже имеет в наличии сервера для базы данных и бэкэнда, таким образом, капитальные затраты только на закупку сервера для работы ML модели и его интеграцию в существующую систему и операционные на его обслуживание в центре обработки данных. Затраты на приобретение сервера от 350000 рублей за бывший в употреблении вариант до 550000 рублей за новый сервер. Работы по интеграции оборудования до 100000 рублей. Операционные затраты 10000 рублей в месяц.

Риски и достоинства использования разрабатываемой системы сведены в таблицу SWOT анализа.
![SWOT](/Task_1_Business_Understanding/swot-image.png "SWOT")
Для нивелирования рисков и уязвимостей на время разработки и во время эксплуатации запланированы следующие шаги:
1. Параллельная работа системы рекомендаций на базе Recombee позволит работать бизнесу не хуже чем раньше, по мере появления новых фич они будут раскатываться в продакшене и улучшать метрики.
2. Высокие затраты на инфраструктуру на начальном этапе постепенно в течении 3-4 лет будут компенсированы за счет отказа от платных услуг сторонних сервисов и эффектов описанных в целях проекта.
3. Поддержка и доработка, а так же ошибки в алгоритмах должны нивелироваться с помощью системы мониторинга и A/B тестирования непрерывно всё время работы системы.

## Решаемые задачи с точки зрения аналитики
Для обучения и тестирования будем использовать dataset-ы представленные на kaggle:
[Insta Cart Online Grocery Basket Analysis](https://www.kaggle.com/datasets/yasserh/instacart-online-grocery-basket-analysis-dataset)<br />[Dunnhumby The Complete Journey](https://www.kaggle.com/datasets/frtgnn/dunnhumby-the-complete-journey)<br />[https://calendarific.com/](https://calendarific.com/)<br />[FRED Economic Data](https://fred.stlouisfed.org/tags/series?ob=pv)

Данные разобъем на три части:
Обучающая выборка 60%;
Валидационная выборка 20%;
Тестовая выборка 20%;
В связи с тем, что данные содержат временные параметры, сохраним хронологический порядок. Обучая выборка из наиболее старых данных, валидационная на более новых, тестовая самые последние данные.


В результате работы модели планируется получить ранжированные списки из рекомендаций. Для оценки ранжированных списков будем использовать метрику MAP@5. На каждой рекомендации будем применять формулу:
$$AP@N = \sum_{k=1}^{N}(precision\ at\ k) \cdot (change\ in\ recall\ at\ k) = \sum_{k=1}^{N}P(k)\Delta r(k)$$
$$AP@5 = \sum_{k=1}^{5}(precision\ at\ k) \cdot (change\ in\ recall\ at\ k) = \sum_{k=1}^{5}P(k)\Delta r(k)$$
Затем получим среднее значение, mean, метрика MAP@10.
В качестве бейзлайна возьмем значения для MAP@10 для разрабатываемой системы 0.15<br />В результате улучшения модели планируется получить MAP@10>0.3.
Для измерения, насколько хорошо система может рекомендовать разнообразные элементы из доступного каталога, будем применять метрику coverage, которая вычисляется по следующей простой формуле:
$$Coverage = \frac{|Рекомендованные\ объекты|}{|Все\ доступные\ объекты|}$$
Значение coverage для бейзлайна определим на уровне 5%<br />Значение coverage после оптимизации модели на уровне 60%<br />Дополнительно будем контролировать насколько рекомендации уникальны для разных пользователей, то есть насколько система избегает шаблонных предложений, для этих целей будем использовать метрику Personalization. Вычислять которую будем через косинусное сходство векторов.
$$Personalization = 1 - \frac{2}{N(N-1)} \sum_{u=1}^{N} \sum_{v=u+1}^{N} \text{cosine\_sim}(R_u, R_v)$$
Значения Personalization для бейзлайна менее 30%.<br />Целевое значение 70%.

Выбранные метрики и пороги сведены в таблицу:
| Метрика          | Baseline Value          | Target Value            |
|-----------------|-------------------------|-------------------------|
| **MAP@5**       | 0.15 | 0.3 |
| **Coverage**    | 0.05 | 0.6% |
| **Personalization** | 0.3 | 0.7 |

## План проекта

### Бизнес-анализ
Сроки: 26.05.2025 - 09.06.2025
1. Выработать бизнес-цели проекта.


### Анализ и подготовка данных
Сроки: 02.06.2025 - 16.06.2025
1. Проверить распределения в данных на нормальность.
2. Выдвинуть и проверить гипотезы на данных.
3. Удалить ненужные признаки.
4. Заполнить пропущенные значения.
5. Уменьшить размерность данных.
6. Визуализировать данные.
7. Преобразовать признаки.
8. Сформировать дополнительные признаки, объединить данные из наборов.
9. Нормализовать данные.


### Моделирование
Сроки: 09.06.2025 - 07.07.2025
1. Выбрать алгоритмы.
2. Подобрать гиперпараметры.
3. Обучить модель.
4. Проверить на валидационной выборке, при необходимости повторить.


### Оценка решения
Сроки: 30.06.2025 - 14.07.2025
1. Проверить модель на тестовой выборке, при необходимости вернуться к предыдущему этапу.


### Внедрение
Сроки: 07.07.2025 - 28.07.2025
1. Подготовить backend.
2. Подготовить frontend.
3. Подготовить pipeline.
4. Протестировать решения.
5. Выполнить deploy.


### Тестирование и мониторинг
Сроки: постоянно начиная с 21.08.2025 
1. Повести дифференциальное тестирование.
2. Провести контрольное тестирование.
3. Провести нагрузочные тесты.
4. Провести A/B тестирование.
5. Выполнить изменения при выявлении проблем, повторить.
6. Постоянно мониторить работу модели.





 